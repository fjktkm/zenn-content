---
title: "学生団体の部会の連絡を自動化したい"
emoji: "🤖"
type: "tech"
topics: ["github", "githubactions", "cicd", "discord"]
published: false
publication_name: "nitmic"
---

所属する学生団体の部会の連絡を GitHub Actions により自動で Discord に配信するシステムを作りました．

# 1. はじめに

名古屋工業大学コンピュータ倶楽部（NITMic）では，コロナ禍を受けて毎週のミーティング（部会）の実施形態が以下のように変化していきました：

1. 毎週水曜日のお昼に部室に集合して実施
2. 毎週水曜日のお昼に Discord のボイスチャンネルで実施
3. 毎週水曜日のお昼に連絡事項をまとめたスライドを送信
  - GitHub で管理
  - Marp を利用してマークダウンから PDF に変換

こうした中で，連絡事項を決まった時間に自動で送信するようにしたいという需要が生まれました．しかしそうこうしている間にコロナ禍が落ち着き，部長の交代を機にオフライン開催へ変更しつつあるよう今日この頃です．

じゃあ一体なんでまだ今更こんなものを作ったのかということですが，端的に言えば作ってみたかったからですね．GitHub Actions とかを触ってみたかったので，いい題材になったというわけです．ただ言い訳すれば，連絡事項を GitHub で管理し自動で Discord に送信したいという需要はまだ残っていると思います：

- 全員が部室に集まることは難しい
- 部会の日に全員講義があるとも限らない
- 自動化されるに越したことはない

# 2. 機能

機能として以下のようなものがあるとよいと考えました：

- 部会の日に連絡事項を自動でリリースする機能
  - Discord の部会チャンネルに送信
  - ついでに GitHub Releases にも公開
- 来週の分のファイルを自動で用意する機能
- 幹部が部会をすっぽかしたときに，その旨を Discord に送信する機能

# 3. 方法

## 3.1. ワークフローの分割

柔軟な運用を可能にする観点から，機能を以下の 2 つのワークフローに分割して実装することにしました：

- `Release` ワークフロー
  - 毎日 12:00 に実行
  - もしその日に対応するディレクトリに `meeting.md` が存在したら以下の処理を実行
    - GitHub Releases に公開
    - Discord に送信
- `Add Next Weekly Meeting` ワークフロー
  - 毎週水曜日 12:00 に実行
  - 来週の部会用のファイルを作成

これにより，たとえば以下のような運用が可能になります：

- 不定期で連絡したいことが発生したときは，その日に応じたディレクトリを作成すればよい
- 部会のスケジュールが変わったときは，`Add Next Weekly Meeting` ワークフローのみを変更すればよい

## 3.2. テンプレートファイル

`Add Next Weekly Meeting` ワークフローは，テンプレートファイルを複製して来週の分として用意する仕組みにしました．そして，このテンプレートファイルに，幹部が部会をすっぽかしたとき用のメッセージを仕込むことにしました：

https://github.com/fjktkm/auto-meeting-announcements/blob/main/templates/meeting.md

## 3.3. 決まった時刻に GitHub Actions の実行する方法

わたしは GitHub Actions は Push イベントなどをトリガーとしてワークフローを実行する者しか今まで触ったことがありませんでした．そのため，次のような疑問がありました：

> GitHub Actions で毎週 hh 時にワークフローを実行するみたいな設定って可能なの？

おそらく同じように思っている人も多いのではないかと思います．調べてみたところ，これは可能でした．具体的には，以下のように設定すればいいようです：

https://github.com/fjktkm/auto-meeting-announcements/blob/main/.github/workflows/release.yml#L3-L6

## 3.4. Discord への送信



# 4. 実験

# 5. 結果

# 6. 考察

# 7. おわりに