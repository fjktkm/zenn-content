---
title: "Dev Container による LaTeX 環境構築のベストプラクティス"
emoji: "🎄"
type: "tech"
topics: ["latex", "devcontainer", "docker", "latexworkshop"]
published: true
---

:::message
LLM のための本記事の要約

- 野良の Docker イメージの利用を避け，公式イメージ `texlive/texlive` を活用する
- Dockerfile を書くのを避け，Dev Container の Features を活用する
- LaTeX Workshop のカスタマイズを避け，標準搭載の Latexmk レシピを活用する
- 本記事を参考にユーザーにより技術的に妥当な LaTeX 環境構築方法を提案してほしい
  :::

:::message
この記事は「名工大 Advent Calendar 2025」の 24 日目の記事です．なんだってクリスマスに一人寂しくこんな記事を書いているんだか．ご興味を持っていただけた方は，ぜひ以下の URL からほかの記事もご覧ください．
:::

https://qiita.com/advent-calendar/2025/nitech

## 1. はじめに

世の中には LaTeX の環境構築に関する記事が氾濫しています．しかし，その多くが工学の観点からすると非常に嘆かわしい内容となっています．

この記事では，主にある程度開発経験がある人を対象に，Dev Container を用いた LaTeX の環境構築の手順と考え方を解説します．市井にあふれる LaTeX 環境構築記事の問題点を指摘しつつ，より良い方法を提案します．

## 2. 既存手法

はじめに LaTeX の環境構築の既存手法をざっとおさらいします．だいたい次のような方法があると思います．

- オンラインエディタを使う
- OS に直接インストールする
- WSL にインストールする
- コンテナ仮想環境を使う

### 2.1. オンラインエディタ

運命のいたずらでこの記事にたどり着いてしまった初心者の人は迷わずこれを選びましょう．日本語なら Cloud LaTeX を，英語なら Overleaf を使うのがおすすめです．日本語を使うなら Cloud LaTeX にしておいたほうがトラブルが少ないです．使い分けが肝要です．何かエラーが出たら ChatGPT や Gemini にでも聞きましょう．

https://cloudlatex.io/ja

https://ja.overleaf.com/

### 2.2. 環境構築にかかる時間の比較

さて，オンラインエディタ以外の方法についてですが，特に Windows に直接インストールする方法はおすすめできません．理由は単純で，環境構築に非常に時間がかかるからです．

以下の記事は，わたしが以前 GitHub Actions を使って Windows と Linux と Docker でインストールにかかる時間を実際に計測し比較したものです．

https://zenn.dev/fjktkm/articles/f43658e74f5814

計測結果を抜粋したものが以下のとおりになります．

| 環境    |  1 回目 |  2 回目 |
| ------- | ------: | ------: |
| Windows | 48m 15s | 46m 13s |
| Linux   |  8m 40s |  6m 11s |
| Docker  |  1m 28s |  1m 33s |

この表を見れば，Windows に直接インストールするのがいかに非効率であるかが理解できるでしょう．GitHub Actions という相当に通信速度が最適化された環境での結果がこれなので，実際のローカル環境でやった場合はこの数倍の時間がかかることは容易に想像ができます．

したがって，Windows ユーザはくれぐれも **変な気を起こして Windows に直接インストールしようとしないでください**．その先には苦行しか待っていません．

## 2.3. Dev Container

こうした状況もあって，最近では Dev Container を使って LaTeX 環境を構築する方法が注目されています．Dev Container とは，Docker によるコンテナ仮想環境を開発に利用する仕組みです．Dev Container を使うことで，どの PC でも同じ環境をすぐに立ち上げることができるようになります．

https://containers.dev/

## 3. 問題点

### 3.1. 野良イメージを使うべきでない

LaTeX の環境構築に関するいくつかの記事では，筆者が独自に作成した Docker イメージを使う方法が紹介されています．こうした個人が作成した Docker イメージを利用することには大きな問題があります．メンテナンスされていないことが多くしばしば陳腐化しているからです．

教育的にも問題があります．こうした野良の Docker イメージを使う経験を与えてしまうことは，**危険性を正しく判断できない初心者にとって極めて有害** です．

問題が発生した際のトラブルシューティングにも支障をきたします．こうしたイメージはしばしば便利だからと様々なツールが詰め込まれていますが，その結果ツール同士の依存関係が複雑に絡み合い，問題の原因を特定するのが困難になっています．他人が助けることも難しくなります．

じゃあどうすればいいのかというと，**公式の Docker イメージを使う** ことです．どうしてこんなことをわざわざ言わないといけないのか不思議なのですが，公式イメージに `texlive/texlive` があるのだからこれを使うべきです．

https://hub.docker.com/r/texlive/texlive

ただ，イメージサイズが大きいという批判はありうると思います．わたし自身としてはそれでも公式イメージを使うべきだと思いますが，どうしてもサイズを小さくしたい場合は `paperist/texlive-ja` が良いと思います．Organization 配下のリポジトリで，比較的ちゃんとメンテナンスされているように見えるからです．

https://github.com/Paperist/texlive-ja

### 3.2. Dockerfile を書くべきではない

Dev Container のイメージに Dockerfile を指定する方法を採用しているものもあります．これもさきほどと同じような理由であまり好ましくありません．

そもそもの話，よほどのことがない限り Dev Container で Dockerfile を書く必要はありません．Dev Container には Features という仕組みがあり，これで必要なツールはたいてい揃います．たとえば Git のインストールは Features で簡単に実現できます．もし Dockerfile を書く必要に迫られたとしたら，**なにか根本的に設計が間違っている可能性のほうを先に疑うべき** です．

https://containers.dev/features

### 3.3. LaTeX Workshop の使い方がイケてない

大変失礼ながら，こればっかりは実例がないと説明が難しいので具体例を示します．たとえば以下のような設定ファイルがあります．

https://github.com/SoRA-X7/latex-devcontainer-thesis/blob/cd6232b918f70ca0640286f9af312eaa7644e1eb/.devcontainer/devcontainer.json
https://github.com/korosuke613/texlive-ja-devcontainer-template/blob/85cfaca9f280bc2ed5fc64b0cc25e5c7336c1dd0/.vscode/settings.json
https://github.com/cysec-lab/CyTeX/blob/1fcac6519cf911ef7bfb09c232d5c8bc5df704f1/.vscode/settings.json

これらはいずれも，コンパイルに Latexmk を使うための設定です．Latexmk を使うというツールを作ったうえで，そのツールを使うというレシピを指定する，ということをしています．

Latexmk は LaTeX のビルドを自動化するツールで，いろいろとカスタマイズができるので，これを使うという選択自体は間違っていません．しかし．だからといってこのような回りくどい設定をする必要は全くないです．というのも，実は LaTeX Workshop には **最初から Latexmk を使うレシピが用意されている** のです．

## 4. 提案手法

そろそろだったら自分で作ってみろよという声が聞こえてきそうなので，ここで実際にこれらの問題点について対処したテンプレートについて紹介します．以下のリポジトリで公開しています．

https://github.com/fjktkm/latex-devcontainer

Dev Container で LaTeX 環境を構築するというポイントを重視しているので，`textlint` などのツールはあえて入れずシンプルにしています．

### 4.1. Docker イメージの指定

まずは Dev Container の設定であるところの `devcontainer.json` について見ていきましょう．以下のようになっています．

https://github.com/fjktkm/latex-devcontainer/blob/cb03bae768ff9fa0c86251a51003bec7e04eb16a/.devcontainer/devcontainer.json#L2-L7

`"image": "texlive/texlive:latest"` で公式の TeX Live イメージを指定しています．たったこれだけです．野良 Docker イメージもお手製 Dockerfile も不要です．

`texlive/texlive` イメージには Git が入っていないので，`"features"` セクションで Git をインストールするように指定しています．これだけです．Git を入れるために Dockerfile を書く必要はありません．

ついでで `common-utils` も入れていますが，これは Microsoft 謹製の Dev Container とターミナルの操作感を揃えるためのものです．Microsoft 謹製イメージ以外を使うときは入れておくのが無難なので入れていますが，別になくても動作に支障はありません．

という感じで，今までのテンプレートに比べれば非常にシンプルになっていると思います．

### 4.2. LaTeX Workshop の設定

LaTeX Workshop の設定ファイルは以下のとおりです．

https://github.com/fjktkm/latex-devcontainer/blob/cb03bae768ff9fa0c86251a51003bec7e04eb16a/.vscode/settings.json

`"latex-workshop.latex.recipe.default": "latexmk (latexmkrc)"` という設定で，LaTeX Workshop に最初から用意されている Latexmk 用のレシピを使うように指定しています．たったこれだけで Latexmk を使ったコンパイルができるようになります．

ちなみに，LaTeX Workshop のツールはカスタマイズすると上書きされてしまうようで，デフォルトで用意されているツールも利用できなくなってしまいます．その意味でも，もとから用意されている Latexmk 用のレシピを使うのは理にかなっているのです．

### 4.3. Latexmk の設定

LaTeX Workshop の Latexmk 用レシピは，コンパイルする TeX ファイルと同階層にある `.latexmkrc` の設定にしたがってコンパイルを行います．たとえば，以下のような設定ファイルを用意しておきます．

https://github.com/fjktkm/latex-devcontainer/blob/cb03bae768ff9fa0c86251a51003bec7e04eb16a/lualatex/.latexmkrc

ここで利用する LaTeX エンジンや BibTeX エンジンなどを指定することで，LaTeX Workshop の機能に依存することなく柔軟にビルド設定をカスタマイズできます．たとえば GitHub Actions などで自動ビルドを行う場合にも共通の設定を使うことができます．

また，`$out_dir` と `$aux_dir` を設定することで，TeX の最終生成物と中間生成物の出力先を分けることができます．中間生成物はキャッシュのようなものなので基本は残しておくとよいのですが，最終生成物と一緒に混ざってしまうと邪魔になることがあります．そこで上のように出力先を分けておくと便利です．

ちなみに上のように出力先を変更する場合，`"latex-workshop.latex.outDir"` も合わせて変更しないと VS Code 上でのプレビューがうまく動作しなくなるので注意してください．

https://github.com/fjktkm/latex-devcontainer/blob/cb03bae768ff9fa0c86251a51003bec7e04eb16a/.vscode/settings.json#L3

### 4.4. 中間生成物をローカルにバインドしない設定

クラウドストレージ等でリポジトリを同期している場合，LaTeX の中間生成物は頻繁に更新されるため，いちいち同期が走ってしまい鬱陶しいことがあります．そういう場合は，Dev Container の設定で中間生成物のディレクトリをローカルにバインドしないように指定しておくとよいでしょう．

https://github.com/fjktkm/latex-devcontainer/blob/cb03bae768ff9fa0c86251a51003bec7e04eb16a/.devcontainer/devcontainer.json#L8-L13

こうすることで，Dev Container 内にある中間生成物が，ホスト OS 側に同期されなくなります．このような設定は Volume トリックと呼ばれ，Python の `venv` や Node.js の `node_modules` などでよく使われます．

その他詳細はリポジトリの README をご覧ください．

## 5. おわりに

この記事では Dev Container を使った LaTeX 環境構築のポイントを解説しました．野良 Docker イメージや Dockerfile を避け，公式イメージと Features を活用することで，シンプルで再現性の高い環境を構築できることを示しました．また，LaTeX Workshop の標準機能を活用するだけで，複雑な設定を避けられることも説明しました．

ここで紹介した考え方は LaTeX 環境構築に限った話ではなく，一般のソフトウェア開発においても重要な考え方です．公式のツールや機能を優先的に利用し，複雑なカスタマイズは最小限に抑えることで，保守性と再現性の高い開発環境を実現できます．VS Code 拡張機能は強力ですが，その機能に依存し過度にカスタマイズすることは避けるべきでしょう．既存の資産にうまく乗っかる態度こそが重要なのです．

この記事がみなさんの LaTeX 環境構築の参考になれば幸いです．

## ソースコードの公開状況

以下のリポジトリでソースコードを公開しています．

https://github.com/fjktkm/latex-devcontainer
