---
title: "大学のホスティングサービスでも CI/CD したい"
emoji: "🤖"
type: "tech"
topics: ["github", "githubactions", "cicd"]
published: false
---

この記事では，GitHub の Self Hosted Runner を用いて Web サイトのデプロイを自動化した話をします．ホスティングする Web サイトは，わたしの所属する名古屋工業大学コンピュータ俱楽部 NITMic の公式サイトです．ホスティングサービスは，大学の提供する課外活動団体向けのホスティングサービスを利用しています．大学のように制約のあるネットワークにおいて CI/CD したい場合の参考になれば幸いです．

:::message

:::

## 1. はじめに

NITMic では，大学の提供するホスティングサービスを利用しています：

https://nitmic.club.nitech.ac.jp/

このホスティングサービスは，セキュリティ上の観点から大学のネットワークからしかアクセスできないように設定されています．

また，公式サイトについては HUGO を利用して構築しています．

## 2. 背景

大学の提供するホスティングサービスには，CI/CD を実現できそうないくつかの機能があります．

- Git 連携機能
- FTP 接続
- SSH 接続
- ホスティングタイプを転送に設定
- GitHub Pages のカスタムドメイン

しかし，これらの手法はことごとく失敗に終わります．

### 2.1. Git 連携機能

まず，Git 連携機能とはなんぞやという話ですが，ざっくりと言えば GitHub のリポジトリに Push があったときに Webhook をトリガーにホスティングサーバ側でで Pull するというものです．

第一に，この方法にはビルドに関する問題があります．この機能で実現するのは Pull だけなので，通常ならホスティングサーバ上でビルドする必要があります．しかし，ホスティングサーバにはもちろん HUGO はインストールされておらず，またインストールする権限もありません．したがって，ビルド済みファイルを Orphan ブランチなどに忍ばせるといった面倒なことをする必要があるのです．

https://engawapg.net/software-development/2393/github-pages-branch/

第二に，これが致命的ではあるのですが，Webhook の受信エンドポイントに対するアクセスはホスティングサーバへのアクセスということになります．したがって，GitHub などの学外ネットワークからはアクセスできません．

### 2.2 FTP 接続

### 2.2. SSH 接続

### 2.3. ホスティングタイプを転送に設定

### 2.4. GitHub Pages のカスタムドメイン

## 3. 方法


## 実験

## 結果

## 考察

## 結論
